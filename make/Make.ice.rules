# **********************************************************************
#
# Copyright (c) 2003-2015 ZeroC, Inc. All rights reserved.
#
# This copy of Ice is licensed to you under the terms described in the
# ICE_LICENSE file included in this distribution.
#
# **********************************************************************

#
# Support for 3rd party libraries
#
thirdparties		:= bz2
bz2_home 		:= $(BZ2_HOME)

#
# Support for Ice libraries
#
dependencies 		= Ice Glacier2 IceGrid IcePatch2 IceSSL IceStorm

slice2cpp_targetext	= cpp
slice2cpp_path		= $(ice_bindir)/slice2cpp

slice2objc_targetext	= m
slice2objc_path		= $(ice_bindir)/slice2cpp

slice2php_targetext	= php
slice2php_path		= $(ice_bindir)/slice2php


# Ice
Ice_libs                := bz2
Ice_system_libs         := $(ICE_OS_LIBS) $(ICEUTIL_OS_LIBS)

# Glacier2
Glacier2_dependencies	:= Ice

# IceGrid
IceGrid_dependencies    := Glacier2 Ice

# IcePatch2
IcePatch2_dependencies  := Ice
IcePatch2_libs          := bz2

# IceSSL
IceSSL_dependencies     := Ice
IceSSL_system_libs      := $(SSL_OS_LIBS)

# IceStorm
IceStorm_dependencies   := Ice

#
# Helpers to define 3rd party libraries variables
#
define make-thirdparty
ifneq ($($1_home),)
# Check for 3rd party libraries either in home/lib<platform specific subdir> or home/lib
$1_libdir	?= $$(strip $$(if $$(wildcard $$($1_home)/lib$$(call platform-var,installdir,$$1,$$2,$$3)),\
			$$($1_home)/lib$$(call platform-var,installdir,$$1,$$2,$$3),$$($1_home)/lib))
endif
$1_ldflags	?= -l$1
endef
$(foreach l,$(thirdparties),$(eval $(call make-thirdparty,$l)))

#
# Helpers to define Ice dependency variables
#
ice_targetdir 	= $(ice_libdir)
ice_version 	=
ice_soversion	=
$(foreach d,$(dependencies),$(eval $(call create-component-targets,ice,$d,library)))

